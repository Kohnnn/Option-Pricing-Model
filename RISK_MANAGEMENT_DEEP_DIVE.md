# Risk Management Deep Dive

This document provides a detailed theoretical overview and implementation notes for the risk management models used in this project.

## 1. Value at Risk (VaR)

Value at Risk (VaR) is a statistical measure used to quantify the level of financial risk within a firm, portfolio, or position over a specific time frame. It estimates the maximum potential loss with a given degree of confidence.

### a. Historical VaR

**Concept:**
Historical VaR is the simplest method to calculate VaR. It uses historical data to determine the worst-case loss that a portfolio could have experienced over a given period.

**Implementation:**
- The `historical_var` method in the `ValueAtRisk` class calculates VaR by sorting historical returns and finding the percentile corresponding to the chosen confidence level.
- For example, a 99% confidence level means we look at the 1st percentile of the historical return distribution.

### b. Parametric VaR (Variance-Covariance)

**Concept:**
Parametric VaR assumes that returns are normally distributed. It uses the mean and standard deviation of historical returns to calculate VaR.

**Implementation:**
- The `parametric_var` method calculates the Z-score corresponding to the confidence level and uses it along with the mean and standard deviation to estimate VaR.
- This method is computationally efficient but may be inaccurate if returns are not normally distributed.

### c. Monte Carlo VaR

**Concept:**
Monte Carlo VaR uses computational algorithms to create a large number of possible outcomes for a portfolio's value. It then uses this distribution of outcomes to calculate VaR.

**Implementation:**
- The `monte_carlo_simulation` method generates thousands of random price paths for the assets in the portfolio using Geometric Brownian Motion (GBM).
- The resulting distribution of profit and loss (P&L) is then used to calculate VaR, similar to the historical method.

## 2. Conditional Value at Risk (CVaR)

Conditional Value at Risk (CVaR), also known as Expected Shortfall, measures the expected loss when the loss exceeds the VaR threshold. It provides a more complete picture of risk by considering the severity of losses beyond the VaR point.

### a. Historical CVaR

**Concept:**
Historical CVaR is calculated by taking the average of all losses that are greater than the historical VaR.

**Implementation:**
- The `historical_cvar` method first calculates the VaR and then averages the returns that are lower than the VaR value.

### b. Monte Carlo CVaR

**Concept:**
Similar to Monte Carlo VaR, this method uses the simulated P&L distribution. CVaR is the average of the simulated losses that exceed the Monte Carlo VaR.

**Implementation:**
- The `get_cvar_from_pnl` method calculates CVaR from the P&L distribution generated by the Monte Carlo simulation.

## 3. Stress Testing

Stress testing is a simulation technique used to determine how a portfolio would perform under extreme market conditions.

**Concept:**
Stress tests involve creating hypothetical scenarios, such as a stock market crash or a sharp rise in interest rates, and then re-valuing the portfolio to see the impact.

**Implementation:**
- The `StressTester` class allows users to define custom scenarios by specifying a shock to an asset's price (either as a percentage or an absolute value).
- The `run_stress_test` method applies these shocks to a copy of the portfolio and calculates the resulting P&L, providing insight into the portfolio's resilience.